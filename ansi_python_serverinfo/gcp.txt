from google.cloud import bigquery
from google.auth import jwt

def connect_to_bigquery(url, json_key_path):
    # Load credentials from the JSON key file
    creds = jwt.Credentials.from_service_account_file(json_key_path, target_principal=url)

    # Create a client using the obtained credentials
    client = bigquery.Client(credentials=creds)

    # Extract the project ID from the client object
    project_id = client.project

    return client, project_id

def display_project_details(client):
    # Get the project details
    project = client.project

    print("Connected to project ID:", project)
    print("Datasets in the project:")

    # List datasets in the project
    datasets = client.list_datasets()

    for dataset in datasets:
        print(dataset.dataset_id)

# URL and JSON authentication path
url = 'https://www.googleapis.com/auth/bigquery'
json_key_path = 'path/to/your/json_key.json'

# Connect to BigQuery
client, project_id = connect_to_bigquery(url, json_key_path)

# Display project details
display_project_details(client)
